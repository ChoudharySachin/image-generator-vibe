<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutero Content Studio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="static/css/style.css?v=6">
</head>

<body>
    <div class="app-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>
                    <img src="static/images/bot-head.png" alt="">
                    Tutero Image Generator
                </h2>
            </div>

            <div class="history-section-title">Recent Generations</div>

            <div id="history-list" class="history-list">
                <div class="empty-history">No history yet</div>
            </div>

            <!-- API Keys Section -->
            <div class="sidebar-footer">
                <div class="api-keys-accordion">
                    <div class="accordion-header" id="api-keys-toggle">
                        <span class="accordion-icon">ðŸ”‘</span>
                        <span class="accordion-title">API Key</span>
                        <span class="accordion-chevron">â–¼</span>
                    </div>
                    <div class="accordion-content hidden" id="api-keys-content">
                        <div class="api-key-group">
                            <label for="openrouter-key">OpenRouter API Key</label>
                            <input type="password" id="openrouter-key" class="api-input" placeholder="sk-or-...">
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <div class="container">
                <main>
                    <div class="studio-header">
                        <div class="studio-tabs">
                            <button id="tab-generate" class="studio-tab active" data-studio="generate">Generate
                                Studio</button>
                            <button id="tab-edit" class="studio-tab" data-studio="edit">Edit Studio</button>
                        </div>
                        <button id="restart-btn" class="restart-btn">
                            <svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" fill="none"
                                stroke-width="2">
                                <path d="M23 4v6h-6"></path>
                                <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                            </svg>
                            Restart
                        </button>
                    </div>

                    <div id="generate-studio" class="studio-content">
                        <div class="generator-card">
                            <div class="form-section">
                                <!-- Image Type Selection -->
                                <div class="selection-section">
                                    <!-- Top Form Row: Category, Style, Count, Model -->
                                    <div class="form-row">
                                        <!-- Image Type Selection -->
                                        <div class="form-group">
                                            <label for="category-select" class="section-label">Image Type</label>
                                            <select id="category-select" class="form-control">
                                                <option value="" disabled selected>Select Type</option>
                                                <option value="subtopic_cover">Subtopic Cover</option>
                                                <option value="tutero_ai">Tutero AI</option>
                                                <option value="classroom_activity">Classroom Activity</option>
                                                <option value="context_introduction">Context Intro</option>
                                            </select>
                                        </div>

                                        <!-- Style Selection -->
                                        <div class="form-group" id="style-group">
                                            <label for="style-select" class="section-label">Style</label>
                                            <select id="style-select" class="form-control" disabled>
                                                <option value="original">Original</option>
                                            </select>
                                        </div>

                                        <!-- Count Selection -->
                                        <div class="form-group" style="max-width: 100px;">
                                            <label for="count-select" class="section-label">Images</label>
                                            <select id="count-select" class="form-control">
                                                <option value="1" selected>1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                            </select>
                                        </div>

                                        <!-- Model Selection -->
                                        <div class="form-group" style="flex: 1.5;">
                                            <label for="model-select" class="section-label">Model</label>
                                            <select id="model-select" class="form-control">
                                                <option value="google/gemini-2.5-flash-image" selected>Google Nano
                                                    Banana</option>
                                                <option value="google/gemini-3-pro-image-preview">Google Nano Banana Pro
                                                </option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- Orientation Selection -->
                                    <div class="selection-section hidden" id="orientation-section">
                                        <label class="section-label">Orientation</label>
                                        <div class="orientation-grid">
                                            <div class="orientation-tile selected" data-value="landscape">
                                                <div class="orientation-icon">
                                                    <svg viewBox="0 0 24 24" width="24" height="24"
                                                        stroke="currentColor" fill="none" stroke-width="2">
                                                        <rect x="3" y="6" width="18" height="12" rx="2" ry="2"></rect>
                                                        <circle cx="12" cy="12" r="2"></circle>
                                                    </svg>
                                                </div>
                                                <div class="orientation-info">
                                                    <span class="orientation-name">Landscape</span>
                                                    <span class="orientation-ratio">16:9</span>
                                                </div>
                                            </div>
                                            <div class="orientation-tile" data-value="portrait">
                                                <div class="orientation-icon">
                                                    <svg viewBox="0 0 24 24" width="24" height="24"
                                                        stroke="currentColor" fill="none" stroke-width="2">
                                                        <rect x="6" y="3" width="12" height="18" rx="2" ry="2"></rect>
                                                        <circle cx="12" cy="12" r="2"></circle>
                                                    </svg>
                                                </div>
                                                <div class="orientation-info">
                                                    <span class="orientation-name">Portrait</span>
                                                    <span class="orientation-ratio">9:16</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="input-group hidden" id="instruction-section">
                                        <label for="prompt">Image Description</label>
                                        <div class="prompt-container">
                                            <textarea id="prompt" class="form-control" rows="3"
                                                placeholder="Describe your image... e.g., 'A cute robot mascot in a classroom'"></textarea>
                                            <div class="prompt-toolbar">
                                                <label for="file-upload" class="attachment-btn"
                                                    title="Add reference images">
                                                    <svg viewBox="0 0 24 24" width="20" height="20"
                                                        stroke="currentColor" fill="none" stroke-width="2"
                                                        stroke-linecap="round" stroke-linejoin="round">
                                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                                        <polyline points="21 15 16 10 5 21"></polyline>
                                                    </svg>
                                                </label>
                                                <input type="file" id="file-upload" multiple accept="image/*"
                                                    style="display: none;">
                                            </div>
                                        </div>
                                        <div id="attachments-preview" class="attachments-preview"></div>
                                    </div>

                                    <button id="generate-btn" class="btn btn-primary hidden">
                                        <span class="btn-text">Generate Images</span>
                                        <span class="btn-icon">âœ¨</span>
                                    </button>
                                </div>



                                <!-- Results Section -->
                                <div id="results-section" class="results-section" style="display: none;">
                                    <h2>Generated Images</h2>
                                    <div id="results-grid" class="results-grid"></div>
                                    <div class="results-info" style="display:none">
                                        <!-- Hidden as per new design preference, or keep if useful -->
                                        <p id="results-summary"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Edit Studio Content -->
                    <div id="edit-studio" class="studio-content hidden">
                        <div class="generator-card">
                            <div class="form-section">
                                <div class="selection-section">
                                    <div class="form-row">
                                        <div class="form-group" style="max-width: 100px;">
                                            <label for="edit-count-select" class="section-label">Images</label>
                                            <select id="edit-count-select" class="form-control">
                                                <option value="1" selected>1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                            </select>
                                        </div>
                                        <div class="form-group" style="flex: 1.5;">
                                            <label for="edit-model-select" class="section-label">Model</label>
                                            <select id="edit-model-select" class="form-control">
                                                <option value="google/gemini-2.5-flash-image" selected>Google Nano
                                                    Banana</option>
                                                <option value="google/gemini-3-pro-image-preview">Google Nano Banana Pro
                                                </option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="edit-studio-layout">
                                        <div class="edit-upload-section">
                                            <label class="section-label">Image to Edit</label>
                                            <div id="edit-image-container" class="edit-image-container empty">
                                                <div class="upload-placeholder">
                                                    <svg viewBox="0 0 24 24" width="48" height="48"
                                                        stroke="currentColor" fill="none" stroke-width="1.5">
                                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                        <polyline points="17 8 12 3 7 8"></polyline>
                                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                                    </svg>
                                                    <p>Upload an image to edit</p>
                                                    <button class="btn btn-secondary"
                                                        onclick="document.getElementById('edit-file-upload').click()">Choose
                                                        File</button>
                                                </div>
                                                <img id="edit-preview-image" src="" alt="To edit" class="hidden">
                                                <input type="file" id="edit-file-upload" accept="image/*"
                                                    style="display: none;">
                                                <button id="remove-edit-image"
                                                    class="attachment-remove hidden">Ã—</button>
                                            </div>
                                        </div>

                                        <div class="edit-prompt-section">
                                            <div class="input-group">
                                                <label for="edit-prompt">What would you like to change?</label>
                                                <div class="prompt-container">
                                                    <textarea id="edit-prompt" class="form-control"
                                                        placeholder="Describe the changes... e.g., 'Make the robot blue', 'Add a chalkboard'"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <button id="edit-generate-btn" class="btn btn-primary">
                                        <span class="btn-text">Edit Image</span>
                                        <span class="btn-icon">âœ¨</span>
                                    </button>
                                </div>

                                <!-- Results Section -->
                                <div id="edit-results-section" class="results-section" style="display: none;">
                                    <h2>Generated Variations</h2>
                                    <div id="edit-results-grid" class="results-grid"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Refine Image</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="refine-input"
                        style="color:var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem; display:block">Instructions</label>
                    <textarea id="refine-input" class="form-control"
                        placeholder="Make the background brighter, remove the text..." rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary close-modal-btn">Cancel</button>
                    <button id="confirm-refine-btn" class="btn btn-primary" style="width: auto; margin:0;">
                        Refine
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Preview Modal -->
    <div id="preview-modal" class="modal hidden preview-modal">
        <button class="close-preview">&times;</button>
        <div class="preview-content">
            <img id="preview-image" src="" alt="Full Screen Preview">
        </div>
    </div>

    <!-- History Hover Preview -->
    <div id="history-hover-preview" class="history-hover-preview">
        <div class="history-preview-grid" id="history-preview-grid"></div>
    </div>

    <script type="module" src="static/js/app.js"></script>
</body>

</html>