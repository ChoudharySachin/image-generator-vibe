<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Generator - Educational Content</title>
    <!-- Google Fonts Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>

<body>
    <div class="app-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>History</h2>
            </div>
            <div id="history-list" class="history-list">
                <!-- History items will be added here -->
                <div class="empty-history">No history yet</div>
            </div>

            <!-- API Keys Section -->
            <div class="sidebar-footer">
                <div class="api-keys-accordion">
                    <div class="accordion-header" id="api-keys-toggle">
                        <span class="accordion-icon">üîë</span>
                        <span class="accordion-title">API Keys</span>
                        <span class="accordion-chevron">‚ñº</span>
                    </div>
                    <div class="accordion-content hidden" id="api-keys-content">
                        <div class="api-key-group">
                            <label for="openrouter-key">OpenRouter API Key</label>
                            <input type="password" id="openrouter-key" class="form-control api-input"
                                placeholder="sk-or-...">
                        </div>
                        <p class="api-help-text">Keys are stored locally in your browser cache</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <div class="container">
                <header>
                    <h1>
                        <img src="{{ url_for('static', filename='images/tutero-logo.png') }}" alt="Tutero Logo"
                            class="header-logo">
                        Tutero Image Generator
                    </h1>
                </header>

                <main>
                    <div class="generator-card">
                        <div class="form-section">
                            <!-- Image Type Selection -->
                            <div class="selection-section">
                                <label class="section-label">1. Select Image Type</label>
                                <div class="tile-grid" id="category-grid">
                                    <div class="tile" data-value="subtopic_cover">
                                        <div class="tile-icon">üìö</div>
                                        <div class="tile-label">Subtopic Cover</div>
                                    </div>
                                    <div class="tile" data-value="tutero_ai">
                                        <div class="tile-icon">ü§ñ</div>
                                        <div class="tile-label">Tutero AI</div>
                                    </div>
                                    <div class="tile" data-value="classroom_activity">
                                        <div class="tile-icon">üè´</div>
                                        <div class="tile-label">Classroom Activity</div>
                                    </div>
                                    <div class="tile" data-value="context_introduction">
                                        <div class="tile-icon">üåç</div>
                                        <div class="tile-label">Context Intro</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Style Selection (Hidden - Automatic now) -->
                            <div class="selection-section hidden" id="style-section" style="display: none;">
                                <label class="section-label">2. Select Style</label>
                                <div class="tile-grid style-grid" id="style-grid">
                                    <div class="tile style-tile" data-value="original">
                                        <div class="tile-icon">üìê</div>
                                        <div class="tile-label">Original</div>
                                    </div>
                                    <div class="tile style-tile" data-value="glossy_3d">
                                        <div class="tile-icon">üíé</div>
                                        <div class="tile-label">Glossy 3D</div>
                                    </div>
                                    <div class="tile style-tile" data-value="flat_3d">
                                        <div class="tile-icon">üé®</div>
                                        <div class="tile-label">Flat 3D</div>
                                    </div>
                                    <div class="tile style-tile" data-value="minimal_clean_3d">
                                        <div class="tile-icon">‚ú®</div>
                                        <div class="tile-label">Minimal 3D</div>
                                    </div>
                                    <div class="tile style-tile" data-value="paper_craft">
                                        <div class="tile-icon">üìÑ</div>
                                        <div class="tile-label">Paper-craft</div>
                                    </div>
                                    <div class="tile style-tile" data-value="watercolor">
                                        <div class="tile-icon">üñåÔ∏è</div>
                                        <div class="tile-label">Watercolor</div>
                                    </div>
                                    <div class="tile style-tile" data-value="hand_drawn_chalk">
                                        <div class="tile-icon">üñçÔ∏è</div>
                                        <div class="tile-label">Chalk</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Image Count Selection -->
                            <div class="selection-section hidden" id="count-section">
                                <label class="section-label">2. Number of Images</label>
                                <div class="tile-grid count-grid" id="count-grid">
                                    <div class="tile count-tile" data-value="1"><span class="count-label">1</span></div>
                                    <div class="tile count-tile" data-value="2"><span class="count-label">2</span></div>
                                    <div class="tile count-tile" data-value="3"><span class="count-label">3</span></div>
                                    <div class="tile count-tile" data-value="4"><span class="count-label">4</span></div>
                                </div>
                            </div>

                            <!-- Model Selection -->
                            <div class="selection-section hidden" id="model-section">
                                <label class="section-label">3. Select Model</label>
                                <div class="tile-grid model-grid" id="model-grid">
                                    <div class="tile model-tile" data-value="gemini-1.5-flash">
                                        <div class="tile-icon">‚ö°</div>
                                        <div class="tile-label">Gemini Flash</div>
                                    </div>
                                    <div class="tile model-tile" data-value="gemini-1.5-pro">
                                        <div class="tile-icon">üß†</div>
                                        <div class="tile-label">Gemini Pro</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Orientation Selection -->
                            <div class="selection-section hidden" id="orientation-section">
                                <label class="section-label">Orientation</label>
                                <div class="orientation-grid">
                                    <div class="orientation-tile selected" data-value="landscape">
                                        <div class="orientation-icon">
                                            <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor"
                                                fill="none" stroke-width="2">
                                                <rect x="3" y="6" width="18" height="12" rx="2" ry="2"></rect>
                                                <circle cx="12" cy="12" r="2"></circle>
                                            </svg>
                                        </div>
                                        <div class="orientation-info">
                                            <span class="orientation-name">Landscape</span>
                                            <span class="orientation-ratio">16:9</span>
                                        </div>
                                    </div>
                                    <div class="orientation-tile" data-value="portrait">
                                        <div class="orientation-icon">
                                            <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor"
                                                fill="none" stroke-width="2">
                                                <rect x="6" y="3" width="12" height="18" rx="2" ry="2"></rect>
                                                <circle cx="12" cy="12" r="2"></circle>
                                            </svg>
                                        </div>
                                        <div class="orientation-info">
                                            <span class="orientation-name">Portrait</span>
                                            <span class="orientation-ratio">9:16</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Instructions -->
                            <div class="input-group hidden" id="instruction-section">
                                <label for="prompt">Image Description *</label>
                                <div class="prompt-container">
                                    <textarea id="prompt" class="form-control"
                                        placeholder="Describe your image... e.g., 'A cute robot mascot in a classroom, colorful and friendly, digital art style'"
                                        rows="4"></textarea>
                                    <div class="prompt-toolbar">
                                        <label for="file-upload" class="attachment-btn" title="Add reference images">
                                            <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor"
                                                fill="none" stroke-width="2">
                                                <path
                                                    d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                                                </path>
                                            </svg>
                                        </label>
                                        <input type="file" id="file-upload" multiple accept="image/*"
                                            style="display: none;">
                                    </div>
                                    <div id="attachments-preview" class="attachments-preview"></div>
                                </div>
                                <div class="help-text">Be descriptive! Include subjects, style, colors, mood, and
                                    artistic details.</div>
                            </div>

                            <button id="generate-btn" class="btn btn-primary hidden">
                                <span class="btn-text">Generate Images</span>
                                <span class="btn-icon">‚ú®</span>
                            </button>
                        </div>

                        <!-- Progress Section -->
                        <div id="progress-section" class="progress-section" style="display: none;">
                            <div class="progress-bar-container">
                                <div id="progress-bar" class="progress-bar"></div>
                            </div>
                            <p id="progress-status" class="progress-status">Initializing...</p>
                        </div>

                        <!-- Results Section -->
                        <div id="results-section" class="results-section" style="display: none;">
                            <h2>Generated Images</h2>
                            <div id="results-grid" class="results-grid"></div>
                            <div class="results-info">
                                <p id="results-summary"></p>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Refine Image</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="refine-input">What would you like to change?</label>
                    <textarea id="refine-input" class="form-control"
                        placeholder="E.g., Make the background brighter, remove the text..." rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary close-modal-btn">Cancel</button>
                    <button id="confirm-refine-btn" class="btn btn-primary">
                        <span class="btn-text">Refine</span>
                        <span class="btn-icon">‚ú®</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Image Preview Modal -->
    <div id="preview-modal" class="modal hidden preview-modal">
        <button class="close-preview">&times;</button>
        <div class="preview-content">
            <img id="preview-image" src="" alt="Full Screen Preview">
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>

</html>